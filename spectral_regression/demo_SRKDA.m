%[train, train_class] = GenTwoNoisyCircle(200);
%[test, test_class] = GenTwoNoisyCircle(10);
%train = standardizeX(train);
%test = standardizeX(test);

%train = NormalizeFea(train);
%test = NormalizeFea(test);

%train=[0.692099709048954,0.765139707275328;0.258307512398597,0.222647630428175;0.734492771006862,0.728623548490318;0.195359808067980,0.369311289750663;0.819685538079159,0.578474922456873;0.157892055851932,0.437574156933826;0.950300640433118,0.523643455220419;0.0168866901047712,0.608771094521427;0.965055103138795,0.319893122897416;0.183080475593446,0.888655918103015;0.721474591263835,0.0526328986170185;0.441746320277905,0.967360113589981;0.466985774881944,0.00442475866304781;0.827834296657428,0.876890217370683;0.0257179531363319,0.407940971521988;0.993300083709199,0.557448219324416;0.0202886328442409,0.620707597939873;0.984451964483478,0.594000528889122;0.118008157061654,0.187651826375546;0.853366007549549,0.831713422952483;0.0218074510993262,0.588888013528015;0.672674849586033,0.0314599886142497;0.892102025335617,0.773146477053778;0.0734649588463159,0.727992404337093;0.519453318465957,0.0115275474193482;0.838925093146185,0.826310372578837;0.0818472121543652,0.726846259047375;0.791265609461461,0.143594458181282;0.131957865792666,0.804786891233532;0.982374719096960,0.543824476416321;0.485933387067708,0.0163761072765223;0.168621085434151,0.827461931456497;0.948733801120703,0.616783003590802;0.0443087767744973,0.353760289857544;0.911619937820669,0.695840196615977;0.331451295582341,0.0529494418395308;0.287063553759630,0.905755656752667;0.953662164411373,0.431736061113700;0.0268405229911042,0.447518285050463;0.558031987735474,0.950056175047621;0.521450999384550,0.0327167795339376;0.224172618761066,0.870051695413851;0.782280759294821,0.140959714554756;0.917131792872863,0.670093882005044;0.0417379569741411,0.416925789950445;0.526488199801432,0.950188719864573;0.552905543782168,0.0406540589119815;0.951553519015138,0.495191970945373;0.0869182662699724,0.714069135205066;0.316763416616893,0.0642570230524893;0.923707198392845,0.648276166859215;0.182096707652971,0.822028350753286;0.369226734107129,0.0546581469647064;0.851044151912201,0.764821660690554;0.101488990343766,0.719304043250784;0.879641182519636,0.262544719790851;0.125816436575431,0.224014423390594;0.700407314434442,0.889112709975826;0.936043017628576,0.417337064986507;0.0526673854565140,0.591734200006961;0.825702670655967,0.794313908844892;0.242789999194289,0.117326586530713;0.404064408945528,0.931238412644963;0.843073310124796,0.223394123710047;0.0583324536999255,0.373284766927302;0.937966003814107,0.517402884423918;0.229857064462173,0.848305139649142;0.523387930715325,0.0502962242477214;0.163060891143082,0.789646545428263;0.932166006556587,0.569599006683682;0.419509121253775,0.0562700756585192;0.927014083785296,0.588283830832651;0.0486297473107849,0.483918174876899;0.893403794575392,0.299713473308626;0.0681760028505643,0.585654907526395;0.163217810054931,0.199094925334641;0.634810935765788,0.856580721139569;0.793495041571611,0.758518836428852;0.529005276623091,0.876277829428709;0.680527358254896,0.155988567661818;0.149682665541927,0.678305147756244;0.817434371798433,0.727041775575044;0.642813918937992,0.138995739848461;0.692008852134386,0.830776239171385;0.109691922149837,0.434029168763714;0.828798733822193,0.288136590419004;0.505157485108215,0.875511083328104;0.330194419641719,0.152680932031608;0.576252272682985,0.869821312718718;0.114110344474165,0.556379831921074;0.869632431186385,0.417429119988447;0.144016022091782,0.643382327574461;0.289872075021069,0.178953767851823;0.796904199638069,0.735938004163961;0.862716902127593,0.416526900296393;0.304220083531932,0.821125228669793;0.317633084429954,0.169879803408747;0.729116596172396,0.795941716502118;0.199179453530276,0.732885092644347;0.486563804638918,0.132815051360888];
%train_class=[1;1;1;1;1;1;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1];
train=[0.821024032761721,0.416611121377181;0.154938606839770,0.422274094945452;0.792709373116758,0.648766687074306;0.285813284940392,0.0456930051155390;0.690855703317420,0.942046923928864;0.499233012530712,0.0436847144823127;0.545998142319714,0.993956409921544;0.810066660223594,0.123499676949641;0.0230910987051831,0.559383724556432;0.992459008115713,0.405145121873464;0.168747128664738,0.188886110290222;0.925107092553502,0.751094241359957;0.0398846309939929,0.528132763108598;0.825399010433231,0.173067014628194;0.484275392166272,0.975192209967883;0.427326298587182,0.0452318884544436;0.874608188953662,0.771959042159500;0.161828147435627,0.327316646981532;0.932334657346578,0.343306825854790;0.338352100783796,0.814979580060458];
train_class=[1;1;1;2;2;2;2;2;2;2;2;2;2;2;2;2;2;1;2;1];

train1=[0.847587974653204,0.532162251580693;0.484275392166272,0.975192209967883;0.129043590293809,0.510866683800364;0.499233012530712,0.155909464632289;0.862650887914158,0.464879908958933;0.874608188953662,0.771959042159500;0.690855703317420,0.942046923928864;0.154938606839770,0.422274094945452;0.626592963955395,0.852988886522189;0.668848244534677,0.190704050879490;0.323408281198858,0.179409013533062;0.488477545089845,0.841477535823122;0.205736836372652,0.271574042113497;0.925107092553502,0.751094241359957;0.285813284940392,0.0456930051155390;0.810066660223594,0.123499676949641;0.792709373116758,0.648766687074306;0.992459008115713,0.405145121873464;0.239357842666150,0.270122231084572;0.825399010433231,0.173067014628194];
train_class1=[1;2;1;1;1;2;2;1;1;1;1;1;1;2;2;2;1;2;1;2]

test=[0.805376402001636,0.723492219358405;0.619756026447834,0.856237773141218;0.387667995733529,0.869927977332034;0.174992871863548,0.746380463409475;0.120947651598237,0.505936119584205;0.163530956823424,0.257164207029900;0.390455431084157,0.150523105725944;0.619390468671205,0.156759537178210;0.827196771708864,0.272526593240904;0.927468825317983,0.505936119584205;0.926560011185334,0.811537265127542;0.666467205528556,1;0.347094148040480,0.994801440416786;0.0989145654881203,0.801654588449845;0,0.505936119584205;0.0875487613207023,0.201959910625955;0.356425512692535,0.0457897861206317;0.666911208282214,0.0105057392030149;0.907228221545155,0.214380341356911;0.996418609374749,0.505936119584205];
test_class=[1;1;1;1;1;1;1;1;1;1;2;2;2;2;2;2;2;2;2;2];

options = []; 
options.KernelType = 'Gaussian'; 
options.t =0.5; 
options.ReguAlpha = 0.04; 
options.ReguBeta=0.01;
option.Kernel=1;
% for nTrain = [400] 
%   tic;
%   model = SRKDATrain(train, train_class, options); 
%   TimeTrain = toc; 
%   tic;
%   [accuracy,area,predictlabel] = SRKDAPredict(test, test_class, model,'1'); 
%   TimeTest = toc;
%   area
%   disp(['SRKDA,',num2str(nTrain),' Training, Errorrate: ',num2str(1-accuracy),'  TrainTime: ',num2str(TimeTrain),'  TestTime: ',num2str(TimeTest)]); 
% end 

%traing to train and test based on KSR
%option.Kernel=1;
options.ReguType = 'Ridge';
options.gnd=train_class1;
%option.Kernel=1;
KTrain = constructKernel(train1, [], options);
[eigvector, elapseKSR] = KSR_caller(options, KTrain);
Ktest = constructKernel(test, train1, options);
Yhat = Ktest*eigvector;
[X,Y,T,area] = perfcurve(test_class,Yhat,'1');
KTrain=[0.958519215022107,0.513033116431806,0.392050845331851,0.601499806852841,0.949462570035493,0.848856730027293,0.657115606947376,0.411556894810244,0.718245554743713,0.732417795077369,0.478678469859022,0.632031815737341,0.420182635791230,0.853722539945159,0.362526570892284,0.693343248519648,0.929423752703062,0.883119671359387,0.450787996172151,0.747228239009619;0.513033116431806,0.948686936292766,0.508570225878615,0.300755835224025,0.449197971128023,0.646432974596688,0.865899730096967,0.449893746582150,0.886278405399639,0.308258658799591,0.304541666772116,0.921117993089009,0.346208467864720,0.584720491704973,0.206057124940723,0.225939239061357,0.646558660036742,0.321079817062056,0.356891965741773,0.251941028058368;0.392050845331851,0.508570225878615,0.963452568600234,0.587182076290405,0.376160103581537,0.321244823795933,0.385940365580828,0.946531897645718,0.498394301549865,0.469882852388858,0.721923975910725,0.624185364741740,0.848023963635506,0.287335317034606,0.594285416157189,0.317365220987466,0.431144131490523,0.260631426023564,0.838431049343903,0.328938728978130;0.601499806852841,0.300755835224025,0.587182076290405,0.962595191624468,0.637487296544588,0.385481011279029,0.311705286173414,0.672457023050076,0.404326588568780,0.910433869241904,0.903825703150364,0.425213097014776,0.793349836770070,0.372678115996918,0.850576187047161,0.791733836582160,0.540439438256665,0.542175826945778,0.824218819280586,0.780905881937487;0.949462570035493,0.449197971128023,0.376160103581537,0.637487296544588,0.957589610204714,0.792405249093832,0.583339488923105,0.402447756515034,0.649775926912817,0.780232482241265,0.497656286498699,0.570560452109525,0.424889338245681,0.803322105186133,0.386129558411782,0.759009744714078,0.891100747541199,0.912007338034384,0.457008065770056,0.808984447665178;0.848856730027293,0.646432974596688,0.321244823795933,0.385481011279029,0.792405249093832,0.942649076118464,0.832602991562146,0.318123191033370,0.829022574875025,0.479485294949922,0.315627697777407,0.705961722602950,0.295551627545393,0.936128829467563,0.224623494862921,0.431957872669323,0.909866516769726,0.707678575060667,0.315895923194986,0.484256424446751;0.657115606947376,0.865899730096967,0.385940365580828,0.311705286173414,0.583339488923105,0.832602991562146,0.941915115233063,0.356152130195342,0.924125574030638,0.352646651490816,0.284714760944597,0.859468957856858,0.295622761765544,0.785977784328645,0.195933169748751,0.281367872100885,0.787524603191277,0.458559180954326,0.310744192256973,0.317603554001172;0.411556894810244,0.449893746582150,0.946531897645718,0.672457023050076,0.402447756515034,0.318123191033370,0.356152130195342,0.961306825176195,0.466622432959122,0.537608836490236,0.809464857583387,0.574961218710154,0.911712551914576,0.287812546911919,0.695246757029107,0.371990863188928,0.436370710895400,0.285051995634847,0.904721426958103,0.380373022792492;0.718245554743713,0.886278405399639,0.498394301549865,0.404326588568780,0.649775926912817,0.829022574875025,0.924125574030638,0.466622432959122,0.953232181471041,0.441810963937191,0.377396705342095,0.922759537301924,0.393749962714016,0.778222128497871,0.261867891885336,0.347496957165574,0.837937373033676,0.504504187440786,0.412174207838094,0.387221499552347;0.732417795077369,0.308258658799591,0.469882852388858,0.910433869241904,0.780232482241265,0.479485294949922,0.352646651490816,0.537608836490236,0.441810963937191,0.963011377421897,0.768486303111717,0.432228262625545,0.637144910019402,0.476427354059306,0.692424720874389,0.909903461909439,0.640963585892527,0.715634338285297,0.675186105725608,0.911095342080112;0.478678469859022,0.304541666772116,0.721923975910725,0.903825703150364,0.497656286498699,0.315627697777407,0.284714760944597,0.809464857583387,0.377396705342095,0.768486303111717,0.956161063962186,0.426603079613443,0.914696169222644,0.297185776681342,0.912702750766243,0.605988276837313,0.451032103175418,0.390582500864837,0.929026638849712,0.596083326278174;0.632031815737341,0.921117993089009,0.624185364741740,0.425213097014776,0.570560452109525,0.705961722602950,0.859468957856858,0.574961218710154,0.922759537301924,0.432228262625545,0.426603079613443,0.962564408774994,0.469840328435976,0.646105749436245,0.296518510733046,0.321129227094281,0.751964274913371,0.417998249827462,0.485071767752584,0.354219777503967;0.420182635791230,0.346208467864720,0.848023963635506,0.793349836770070,0.424889338245681,0.295551627545393,0.295622761765544,0.911712551914576,0.393749962714016,0.637144910019402,0.914696169222644,0.469840328435976,0.954502468917464,0.272623601912111,0.845440041650798,0.464465050846519,0.418509681712375,0.314286895602710,0.954090852238544,0.463095081111138;0.853722539945159,0.584720491704973,0.287335317034606,0.372678115996918,0.803322105186133,0.936128829467563,0.785977784328645,0.287812546911919,0.778222128497871,0.476427354059306,0.297185776681342,0.646105749436245,0.272623601912111,0.940924008675046,0.212889588945828,0.442863392196392,0.897039752245501,0.740153893641425,0.292387074359367,0.496623285397296;0.362526570892284,0.206057124940723,0.594285416157189,0.850576187047161,0.386129558411782,0.224623494862921,0.195933169748751,0.695246757029107,0.261867891885336,0.692424720874389,0.912702750766243,0.296518510733046,0.845440041650798,0.212889588945828,0.943903970084636,0.554409643476691,0.329419926443260,0.307693489029299,0.854931460332162,0.530486905808430;0.693343248519648,0.225939239061357,0.317365220987466,0.791733836582160,0.759009744714078,0.431957872669323,0.281367872100885,0.371990863188928,0.347496957165574,0.909903461909439,0.605988276837313,0.321129227094281,0.464465050846519,0.442863392196392,0.554409643476691,0.948962003253377,0.571106565039907,0.761700050851148,0.500053168527056,0.944716405343665;0.929423752703062,0.646558660036742,0.431144131490523,0.540439438256665,0.891100747541199,0.909866516769726,0.787524603191277,0.436370710895400,0.837937373033676,0.640963585892527,0.451032103175418,0.751964274913371,0.418509681712375,0.897039752245501,0.329419926443260,0.571106565039907,0.959622198388611,0.784202467309483,0.445991246402012,0.625526384313661;0.883119671359387,0.321079817062056,0.260631426023564,0.542175826945778,0.912007338034384,0.707678575060667,0.458559180954326,0.285051995634847,0.504504187440786,0.715634338285297,0.390582500864837,0.417998249827462,0.314286895602710,0.740153893641425,0.307693489029299,0.761700050851148,0.784202467309483,0.944732820507388,0.341619717565334,0.809023484889811;0.450787996172151,0.356891965741773,0.838431049343903,0.824218819280586,0.457008065770056,0.315895923194986,0.310744192256973,0.904721426958103,0.412174207838094,0.675186105725608,0.929026638849712,0.485071767752584,0.954090852238544,0.292387074359367,0.854931460332162,0.500053168527056,0.445991246402012,0.341619717565334,0.957975324765769,0.498980519924958;0.747228239009619,0.251941028058368,0.328938728978130,0.780905881937487,0.808984447665178,0.484256424446751,0.317603554001172,0.380373022792492,0.387221499552347,0.911095342080112,0.596083326278174,0.354219777503967,0.463095081111138,0.496623285397296,0.530486905808430,0.944716405343665,0.625526384313661,0.809023484889811,0.498980519924958,0.950558297832622];
area1=inference(KTrain,train1,train_class1,test,test_class,options)
area