clear all;
close all;
clc;
nr_runs=1;
data_limit=500;
reguBetaParams=[];
reguAlphaParams=0.01;
kernel_params=0.02;
nr_samples=100;
batch_size=1;

options = [];
options.KernelType = 'Gaussian';
options.t = kernel_params;
options.ReguBeta=0.01;
options.ReguAlpha = reguAlphaParams;      

for r=1:1
    s = RandStream('mt19937ar','Seed',r);
    rand('twister',r*1000);	
    [train, train_class] = GenTwoNoisyCircle(200);
    rand('twister',r*2*1000);
    [test, test_class] = GenTwoNoisyCircle(10);
    rand('twister',r*3*1000);
    %shuffle the training data
    ix=randperm(s,size(train,1))';
    train=train(ix,:);
    train_class=train_class(ix,:);
    %train=NormalizeFea(train);
    %test=NormalizeFea(test);
    train=standardizeX(train);
    test=standardizeX(test);
    %test=train;
    %test_class=train_class;
    rand('twister',r*4*1000);
    [validation, validation_class] = GenTwoNoisyCircle(10);
    validation=standardizeX(validation);
    [ranking,values,current_D,kernel] = MAED(train,train_class,nr_samples,options,data_limit);
    Xs=train(ranking,:)
    Ys=train_class(ranking,:)
   
    %Xs=train;
    %Ys=train_class;
    
%Xs=[0.285813284940392,0.0456930051155390;0.545998142319714,0.993956409921544;0.0773337274724437,0.231487584612656;0.934642240051964,0.277380930163924;0.885345100621182,0.818652711008811;0.234820842158004,0.915879924145174;0.712591848076785,0.0458224072964490;0.00549377623245048,0.436859241694697;0.305333624730813,0.766112624288923;0.452567276581445,0.00556109213341667;0.801455417969915,0.357017943548977;0.386234385540794,0.185367251720535;0.696732591091341,0.0428384147778598;0.0767748931996583,0.767333087462408;0.996048779326550,0.546195929461595;0.967076027825097,0.651244422944851;0.666380765520289,0.781864427708049;0.470531672192840,0.955427753610070;0.0284325606538022,0.514028512784726;0.718020422021734,0.234764465572030];
%Ys=[2;2;2;2;2;2;2;2;1;2;1;1;2;2;2;2;1;2;2;1];
%kernel1=[0.944568349873604,0.189382179355370,0.812528592588219,0.388777310449148,0.190972298146099,0.248896892787971,0.661197481181910,0.606197801230831,0.376703813207268,0.890496007690022,0.485902507791632,0.898148453764085,0.678462536314429,0.335702301817186,0.248972055348764,0.224985988556780,0.292804215271369,0.220363331484001,0.550017895885195,0.623078050405548;0.189382179355370,0.943536921618961,0.232473497237837,0.287029101835780,0.712007791375962,0.769911537794963,0.199814929972515,0.312694943435885,0.768394970910644,0.186853598343464,0.406541147600844,0.295630982076244,0.200130110384101,0.557674402562046,0.441875623318709,0.538366657981721,0.848112740071484,0.931127319435099,0.374131959202399,0.328689230549985;0.812528592588219,0.232473497237837,0.945874005515768,0.256518915246810,0.180794611520721,0.377182153359619,0.415263964724924,0.861471402145741,0.508583572026712,0.653048158945584,0.363017749021859,0.790333234938977,0.429581417077799,0.544587404092240,0.193557163209930,0.188610065335698,0.307175038067773,0.282398446074294,0.805957615828267,0.448346863559783;0.388777310449148,0.287029101835780,0.256518915246810,0.946120836343709,0.537321637666353,0.208315010740653,0.772229302860243,0.209578187952424,0.317433592821452,0.525372816582859,0.909180656697816,0.535285867519126,0.759497755888097,0.188908415321752,0.815356867688011,0.719738397711671,0.521067181140106,0.286834339308688,0.215970312398085,0.866204160274739;0.190972298146099,0.712007791375962,0.180794611520721,0.537321637666353,0.945780625094765,0.417287361736782,0.303428010380099,0.197561782893093,0.505840899329446,0.220250095661760,0.628106136175312,0.307630825792677,0.298923610440651,0.285760421381144,0.797511653428622,0.882962115195937,0.865826388915232,0.655221931044825,0.225779298870845,0.481722755909862;0.248896892787971,0.769911537794963,0.377182153359619,0.208315010740653,0.417287361736782,0.942634919088916,0.187679622546846,0.549506706112189,0.900209880665711,0.214166040996891,0.316507494676422,0.355651364773941,0.190223942753429,0.859965667784196,0.263911110961147,0.312948995334494,0.644888999215647,0.843608654789257,0.637520159298922,0.288950016234023;0.661197481181910,0.199814929972515,0.415263964724924,0.772229302860243,0.303428010380099,0.187679622546846,0.940692920692553,0.292301106122256,0.295362162225517,0.821349744348699,0.777583285961760,0.745898688236916,0.940286844995818,0.200766070723773,0.503883698759755,0.421707158355613,0.362987674646476,0.214990889954881,0.280341851485888,0.885164704350726;0.606197801230831,0.312694943435885,0.861471402145741,0.209578187952424,0.197561782893093,0.549506706112189,0.292301106122256,0.944437659860681,0.652965624609398,0.457755176198408,0.312698109808758,0.643529038959039,0.301901154342668,0.755302055593672,0.182535346780684,0.187679970542072,0.353098563549984,0.384325967662512,0.933338437638343,0.358999110525968;0.376703813207268,0.768394970910644,0.508583572026712,0.317433592821452,0.505840899329446,0.900209880665711,0.295362162225517,0.652965624609398,0.961854863941697,0.334217602314447,0.467466885582317,0.523735346918135,0.299411619596486,0.858371840956696,0.371768242916900,0.419778477481903,0.755247194181297,0.843195809278216,0.729736623499725,0.439447906070614;0.890496007690022,0.186853598343464,0.653048158945584,0.525372816582859,0.220250095661760,0.214166040996891,0.821349744348699,0.457755176198408,0.334217602314447,0.942128163139055,0.599202535772496,0.885337867493922,0.834842473860775,0.264140176016514,0.323041660983404,0.279867467063830,0.310840811071499,0.211054163421310,0.419694464362980,0.749728311742225;0.485902507791632,0.406541147600844,0.363017749021859,0.909180656697816,0.628106136175312,0.316507494676422,0.777583285961760,0.312698109808758,0.467466885582317,0.599202535772496,0.964120932821030,0.665509667899288,0.770653078907898,0.289484233058029,0.826362983112953,0.766109105454041,0.670811279866321,0.413996096078950,0.324778106037596,0.924061204119682;0.898148453764085,0.295630982076244,0.790333234938977,0.535285867519126,0.307630825792677,0.355651364773941,0.745898688236916,0.643529038959039,0.523735346918135,0.885337867493922,0.665509667899288,0.963751491566099,0.759408040739879,0.432127833412459,0.386107244886029,0.356558255219548,0.452442349834943,0.337563918140671,0.614482181626032,0.780262855248718;0.678462536314429,0.200130110384101,0.429581417077799,0.759497755888097,0.298923610440651,0.190223942753429,0.940286844995818,0.301901154342668,0.299411619596486,0.834842473860775,0.770653078907898,0.759408040739879,0.940854998195585,0.205093158834922,0.493051272098973,0.413335456828057,0.361731054775035,0.216016050402220,0.288739344623297,0.882757320733193;0.335702301817186,0.557674402562046,0.544587404092240,0.188908415321752,0.285760421381144,0.859965667784196,0.200766070723773,0.755302055593672,0.858371840956696,0.264140176016514,0.289484233058029,0.432127833412459,0.205093158834922,0.943766627911488,0.205375834377814,0.230884477543065,0.497132241622884,0.652774847444768,0.829840462654946,0.289107619232276;0.248972055348764,0.441875623318709,0.193557163209930,0.815356867688011,0.797511653428622,0.263911110961147,0.503883698759755,0.182535346780684,0.371768242916900,0.323041660983404,0.826362983112953,0.386107244886029,0.493051272098973,0.205375834377814,0.944557106723102,0.922878218994224,0.696778256198337,0.414637434010869,0.198015898586058,0.683704238044585;0.224985988556780,0.538366657981721,0.188610065335698,0.719738397711671,0.882962115195937,0.312948995334494,0.421707158355613,0.187679970542072,0.419778477481903,0.279867467063830,0.766109105454041,0.356558255219548,0.413335456828057,0.230884477543065,0.922878218994224,0.944990517342726,0.775727439187597,0.499184472090904,0.207496524849028,0.611724442281746;0.292804215271369,0.848112740071484,0.307175038067773,0.521067181140106,0.865826388915232,0.644888999215647,0.362987674646476,0.353098563549984,0.755247194181297,0.310840811071499,0.670811279866321,0.452442349834943,0.361731054775035,0.497132241622884,0.696778256198337,0.775727439187597,0.964414160453086,0.836495276089121,0.402556090858749,0.560689615052807;0.220363331484001,0.931127319435099,0.282398446074294,0.286834339308688,0.655221931044825,0.843608654789257,0.214990889954881,0.384325967662512,0.843195809278216,0.211054163421310,0.413996096078950,0.337563918140671,0.216016050402220,0.652774847444768,0.414637434010869,0.499184472090904,0.836495276089121,0.945678133805524,0.455270190777752,0.347143798639762;0.550017895885195,0.374131959202399,0.805957615828267,0.215970312398085,0.225779298870845,0.637520159298922,0.280341851485888,0.933338437638343,0.729736623499725,0.419694464362980,0.324778106037596,0.614482181626032,0.288739344623297,0.829840462654946,0.198015898586058,0.207496524849028,0.402556090858749,0.455270190777752,0.946309076035477,0.359946519133459;0.623078050405548,0.328689230549985,0.448346863559783,0.866204160274739,0.481722755909862,0.288950016234023,0.885164704350726,0.358999110525968,0.439447906070614,0.749728311742225,0.924061204119682,0.780262855248718,0.882757320733193,0.289107619232276,0.683704238044585,0.611724442281746,0.560689615052807,0.347143798639762,0.359946519133459,0.961403804596094];
    
    [ranking,values,current_D,kernel1] = MAED(Xs,Ys,nr_samples,options,data_limit);
    %just check what happens if all data used
    area=run_inference(kernel1,Xs,Ys,test,test_class,options)
    
end


